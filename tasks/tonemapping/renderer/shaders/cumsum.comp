#version 430
#extension GL_GOOGLE_include_directive : require

#include "tonemap.h"

layout(local_size_x = BUCKET_COUNT) in;

layout(binding = 0, std430) restrict buffer A
{
  uint buf[bucketCount];
};

// not the most efficient solution, but one of the easiest
void main()
{
  const uint ind = gl_LocalInvocationIndex;
  uint res = 0;
  for (uint i = 0; i < ind; ++i)
  {
    res += buf[i];
  }
  barrier();
  buf[ind] += res;
}
